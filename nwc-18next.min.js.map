{"version":3,"file":null,"sources":["src/nwc-i18next.js"],"sourcesContent":["const defaults = {\n  tName: 't',\n  i18nName: 'i18n',\n  handleName: 'localize',\n  selectorAttr: 'data-i18n',\n  targetAttr: 'i18n-target',\n  optionsAttr: 'i18n-options',\n  useOptionsAttr: false,\n  parseDefaultValueFromContent: true\n};\n\nwindow.$ = document.querySelectorAll.bind(document);\n\nexport default function init(i18next, $, options = {}) {\n\n  options = Object.assign({}, defaults, options);\n\n  function parse(ele, key, opts) {\n    if (key.length === 0) return;\n\n    let attr = 'text';\n\n    if (key.indexOf('[') === 0) {\n      let parts = key.split(']');\n      key = parts[1];\n      attr = parts[0].substr(1, parts[0].length-1);\n    }\n\n    if (key.indexOf(';') === key.length-1) {\n      key = key.substr(0, key.length-2);\n    }\n\n    function extendDefault(o, val) {\n      if (!options.parseDefaultValueFromContent) return o;\n      return Object.assign({}, o, {defaultValue: val});\n    }\n\n    if (attr === 'html') {\n      ele.html(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr === 'text') {\n      ele.text(i18next.t(key, extendDefault(opts, ele.text())));\n    } else if (attr === 'prepend') {\n      ele.prepend(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr === 'append') {\n      ele.append(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr.indexOf('data-') === 0) {\n      let dataAttr = attr.substr(('data-').length);\n      let translated = i18next.t(key, extendDefault(opts, ele.data(dataAttr)));\n\n      // we change into the data cache\n      ele.data(dataAttr, translated);\n      // we change into the dom\n      ele.attr(attr, translated);\n    } else {\n      ele.attr(attr, i18next.t(key, extendDefault(opts, ele.attr(attr))));\n    }\n  }\n\n  function localize(ele, opts) {\n    let key = ele.attr(options.selectorAttr);\n    if (!key && typeof key !== 'undefined' && key !== false) key = ele.text() || ele.val();\n    if (!key) return;\n\n    let target = ele,\n      targetSelector = ele.data(options.targetAttr);\n\n    if (targetSelector) target = ele.find(targetSelector) || ele;\n\n    if (!opts && options.useOptionsAttr === true) opts = ele.data(options.optionsAttr);\n\n    opts = opts || {};\n\n    if (key.indexOf(';') >= 0) {\n      var keys = key.split(';');\n\n      keys.forEach((m, k) => {\n        if (k !== '') parse(target, k, opts);\n      })\n\n    } else {\n      parse(target, key, opts);\n    }\n\n    if (options.useOptionsAttr === true) {\n      let clone = Object.assign({}, opts);\n\n      delete clone.lng;\n      ele.data(options.optionsAttr, clone);\n    }\n  }\n\n  function handle(opts) {\n    return this.each(function() {\n      // localize element itself\n      localize($(this), opts);\n\n      // localize children\n      var elements =  $(this).find('[' + options.selectorAttr + ']');\n      elements.each(function() {\n        localize($(this), opts);\n      });\n    });\n  };\n\n  // $.t $.i18n shortcut\n  $[options.tName] = i18next.t.bind(i18next);\n  $[options.i18nName] = i18next;\n\n  // selector function $(mySelector).localize(opts);\n  $.fn[options.handleName] = handle;\n}\n"],"names":["init","i18next","$","parse","ele","key","opts","extendDefault","o","val","options","parseDefaultValueFromContent","Object","assign","defaultValue","length","attr","indexOf","parts","split","substr","html","t","text","prepend","append","dataAttr","translated","data","localize","selectorAttr","target","targetSelector","targetAttr","find","useOptionsAttr","optionsAttr","keys","forEach","m","k","clone","lng","handle","this","each","elements","defaults","tName","bind","i18nName","fn","handleName","window","document","querySelectorAll"],"mappings":"sCAae,SAASA,GAAKC,EAASC,WAI3BC,GAAMC,EAAKC,EAAKC,WAedC,GAAcC,EAAGC,SACnBC,GAAQC,6BACNC,OAAOC,UAAWL,GAAIM,aAAcL,IADOD,KAfjC,IAAfH,EAAIU,WAEJC,GAAO,UAEc,IAArBX,EAAIY,QAAQ,KAAY,IACtBC,GAAQb,EAAIc,MAAM,OAChBD,EAAM,KACLA,EAAM,GAAGE,OAAO,EAAGF,EAAM,GAAGH,OAAO,MAGxCV,EAAIY,QAAQ,OAASZ,EAAIU,OAAO,MAC5BV,EAAIe,OAAO,EAAGf,EAAIU,OAAO,IAQpB,SAATC,IACEK,KAAKpB,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAIiB,cAC3C,IAAa,SAATL,IACLO,KAAKtB,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAImB,cAC3C,IAAa,YAATP,IACLQ,QAAQvB,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAIiB,cAC9C,IAAa,WAATL,IACLS,OAAOxB,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAIiB,cAC7C,IAA8B,IAA1BL,EAAKC,QAAQ,SAAgB,IAClCS,GAAWV,EAAKI,OAAQ,QAASL,QACjCY,EAAa1B,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAIwB,KAAKF,OAGzDE,KAAKF,EAAUC,KAEfX,KAAKA,EAAMW,UAEXX,KAAKA,EAAMf,EAAQqB,EAAEjB,EAAKE,EAAcD,EAAMF,EAAIY,KAAKA,eAItDa,GAASzB,EAAKE,MACjBD,GAAMD,EAAIY,KAAKN,EAAQoB,iBACtBzB,GAAsB,mBAARA,IAAuBA,KAAQ,IAAOA,EAAMD,EAAImB,QAAUnB,EAAIK,OAC5EJ,MAED0B,GAAS3B,EACX4B,EAAiB5B,EAAIwB,KAAKlB,EAAQuB,eAEhCD,IAAgBD,EAAS3B,EAAI8B,KAAKF,IAAmB5B,GAEpDE,GAAQI,EAAQyB,kBAAmB,IAAM7B,EAAOF,EAAIwB,KAAKlB,EAAQ0B,gBAE/D9B,MAEHD,EAAIY,QAAQ,MAAQ,EAAG,IACrBoB,GAAOhC,EAAIc,MAAM,OAEhBmB,QAAQ,SAACC,EAAGC,GACL,KAANA,GAAUrC,EAAM4B,EAAQS,EAAGlC,YAI3ByB,EAAQ1B,EAAKC,MAGjBI,EAAQyB,kBAAmB,EAAM,IAC/BM,GAAQ7B,OAAOC,UAAWP,SAEvBmC,GAAMC,MACTd,KAAKlB,EAAQ0B,YAAaK,aAIzBE,GAAOrC,SACPsC,MAAKC,KAAK,aAEN3C,EAAE0C,MAAOtC,MAGdwC,GAAY5C,EAAE0C,MAAMV,KAAK,IAAMxB,EAAQoB,aAAe,OACjDe,KAAK,aACH3C,EAAE0C,MAAOtC,UAtFeI,+DAE7BE,OAAOC,UAAWkC,EAAUrC,KA0FpCA,EAAQsC,OAAS/C,EAAQqB,EAAE2B,KAAKhD,KAChCS,EAAQwC,UAAYjD,IAGpBkD,GAAGzC,EAAQ0C,YAAcT,EA7G7B,GAAMI,UACG,aACG,kBACE,wBACE,uBACF,0BACC,+BACG,gCACc,SAGhCM,QAAOnD,EAAIoD,SAASC,iBAAiBN,KAAKK"}